services:
  backend:
    build:
      context: ./Backend
      dockerfile: API/Dockerfile
    ports:
      - "9080:5000"
    env_file:
      - .env
    environment:
      - ASPNETCORE_URLS=http://+:5000
      - ASPNETCORE_ENVIRONMENT=Production
      # Seq logging - bruger Docker service navn internt (http://seq:80)
      # For ekstern adgang, s√¶t Seq__ServerUrl=https://kahoot-log.mercantec.tech i .env filen
    depends_on:
      - seq
    networks:
      - app-network

  flutterweb:
    build:
      context: ./flutter_app
      dockerfile: Dockerfile
      args:
        - BUILDKIT_INLINE_CACHE=1
    ports:
      - "9081:80"
    depends_on:
      - backend
    env_file:
      - .env
    networks:
      - app-network

  seq:
    image: datalust/seq:latest
    ports:
      - "9082:80"    # HTTP UI og API
      - "5341:5341"  # HTTPS (for ekstern adgang)
    environment:
      - ACCEPT_EULA=Y
      - SEQ_FIRSTRUN_ADMINPASSWORD=Admin123!  
    volumes:
      - seq-data:/data
    restart: unless-stopped
    networks:
      - app-network

networks:
  app-network:
    driver: bridge

volumes:
  seq-data:
